"use strict";angular.module("septWebRadioApp",["ngRoute","ngAnimate","ngCookies","ui.bootstrap","septWebRadioControllers","septWebRadioDirectives","septWebRadioFactories","wu.masonry"]),angular.module("septWebRadioApp").config(["$routeProvider","$locationProvider",function($routeProvider,$locationProvider){$routeProvider.when("/index",{templateUrl:"views/main/main.html"}).when("/stage",{templateUrl:"views/stage/stage.html",controller:"StageCtrl"}).when("/replay",{templateUrl:"views/replay/replay.html",controller:"ReplayCtrl"}).when("/topical",{templateUrl:"views/topical/topical.html",controller:"TopicalCtrl"}).when("/door",{templateUrl:"views/door/door.html",controller:"DoorCtrl"}).when("/backstage",{templateUrl:"views/backstage/backstage.html",controller:"BackstageCtrl"}).otherwise({redirectTo:"/index"}),$locationProvider.html5Mode(!0)}]),angular.module("septWebRadioServices",[]),angular.module("septWebRadioServices"),angular.module("septWebRadioServices").service("applicationServices",["$http","$q","$cookieStore","soundCloudServices",function($http,$q,$cookieStore,soundCloudServices){this.clientId="",this.redirectUri="";var self=this;this.getInitApplication=function(){var token=$cookieStore.get("SC_Token"),initAppPromise=$http.get("init_application").success(function(result){self.clientId=result.clientId,self.redirectUri=result.url,SC.initialize({client_id:self.clientId,redirect_uri:self.redirectUri,access_token:token,scope:"non-expiring"})});return initAppPromise.then(function(){return token?soundCloudServices.me().then(function(user){return user}):void 0})},this.isConnected=function(){return soundCloudServices.isConnected()},this.getConnexionLabel=function(){return self.isConnected()?"Log Out":"Log In"},this.logInLogOut=function(){var promise;return promise=self.isConnected()?soundCloudServices.logOut():soundCloudServices.logIn(),promise.then(function(){return self.getConnexionLabel()})}}]),angular.module("septWebRadioServices"),angular.module("septWebRadioServices").service("soundcloudSearch",["$http","$q","limitToFilter",function($http,$q,limitToFilter){var self=this;this.searching=!1,this.deferred=void 0,this.maxItems=24,this.autoCompleteSearch=function($search){self.searching&&self.deferred.reject(),self.searching=!0,self.deferred=$q.defer(),SC.get("/tracks",{q:$search},function(response){self.deferred.resolve(limitToFilter(response,self.maxItems)),self.searching=!1});var promise=self.deferred.promise;return promise.then(function(response){return response}),promise}}]),angular.module("septWebRadioServices"),angular.module("septWebRadioServices").service("soundCloudServices",["$http","$q","$cookieStore",function($http,$q,$cookieStore){var self=this;this.soundCloudToken=void 0,this.soundCloudUser=void 0,this.getUser=function(){return self.soundCloudUser},this.isConnected=function(){return self.soundCloudUser?!0:!1},this.logIn=function(){var deferred=$q.defer(),promise=deferred.promise;return SC.connect(function(){self.soundCloudToken=SC.accessToken(),$cookieStore.put("SC_Token",self.soundCloudToken),deferred.resolve(self.soundCloudToken)}),promise.then(function(){return self.me()})},this.logOut=function(){var deferred=$q.defer(),promise=deferred.promise;return self.soundCloudToken=void 0,self.soundCloudUser=void 0,$cookieStore.remove("SC_Token"),$cookieStore.remove("SC_User"),deferred.resolve(),promise},this.me=function(){var deferred=$q.defer();SC.get("/me",function(response){self.soundCloudUser=response,$cookieStore.put("SC_User",self.soundCloudUser),deferred.resolve(self.soundCloudUser)});var promise=deferred.promise;return promise.then(function(response){return response}),promise}}]),angular.module("septWebRadioControllers",["septWebRadioServices"]),angular.module("septWebRadioControllers").controller("BackstageCtrl",[function(){}]),angular.module("septWebRadioControllers").controller("DoorCtrl",[function(){}]),angular.module("septWebRadioControllers").controller("MainCtrl",["$scope","applicationServices",function($scope,applicationServices){$scope.connexionButtonLabel=void 0,$scope.user=void 0,applicationServices.getInitApplication().then(function(data){$scope.user=data,$scope.connexionButtonLabel=applicationServices.getConnexionLabel()}),$scope.logInLogOutClick=function(){applicationServices.logInLogOut().then(function(label){$scope.connexionButtonLabel=label})}}]),angular.module("septWebRadioControllers").controller("ReplayCtrl",[function(){}]),angular.module("septWebRadioControllers").controller("StageCtrl",["$scope","soundcloudSearch","utilities",function($scope,soundcloudSearch,utilities){$scope.title="Stage",$scope.isSearching=!1,$scope.searchedTerm=void 0,$scope.searchedItems=[],$scope.search=function(){$scope.searchedTerm&&""!==$scope.searchedTerm&&$scope.searchedTerm.length>=2?($scope.isSearching=!0,soundcloudSearch.autoCompleteSearch($scope.searchedTerm).then(function(response){$scope.searchedItems=utilities.mergeList($scope.searchedItems,response),$scope.isSearching=!1})):($scope.isSearching=!1,$scope.searchedItems.splice(0,$scope.searchedItems.length))}}]),angular.module("septWebRadioControllers").controller("TopicalCtrl",[function(){}]),angular.module("septWebRadioDirectives",[]),angular.module("septWebRadioDirectives").directive("delayedInput",["$timeout",function($timeout){return{restrict:"A",scope:{ngModel:"=",delayedTime:"=",callBack:"&"},link:function(scope){var timer=!1,delayedTime="undefined"!=typeof scope.delayedTime?scope.delayedTime:500;"function"==typeof scope.callBack&&scope.$watch("ngModel",function(newVal,oldVal){newVal!==oldVal&&newVal&&(timer&&$timeout.cancel(timer),timer=$timeout(function(){scope.callBack()},delayedTime))})}}}]),angular.module("septWebRadioFactories",[]),angular.module("septWebRadioFactories"),angular.module("septWebRadioFactories").factory("utilities",[function(){var utilitiesService={};return utilitiesService.removeItem=function(list,itemToRemove){for(var elementLoop,listSize=_.size(list),index=0;listSize>index;index++)if(elementLoop=list[index],elementLoop.id===itemToRemove.id){list.splice(index,1);break}return list},utilitiesService.listContainsId=function(list,element){return utilitiesService.listContainsAttribute(list,element,"id")},utilitiesService.listContainsAttribute=function(list,element,attr){return _.find(list,function(newItem){return element[attr]===newItem[attr]})},utilitiesService.mergeList=function(oldList,newList){for(var element,even,removed=0,oldListSize=_.size(oldList),index=0;oldListSize>index;index++)element=oldList[index-removed],even=utilitiesService.listContainsId(newList,element),void 0===even?(oldList.splice(index-removed,1),removed++):newList=utilitiesService.removeItem(newList,element);return oldList.concat(newList)},utilitiesService}]);